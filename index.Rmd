---
title: "Radiohead"
author: "LÃ©on Caballer"
date: "2024-03-15"
output: flexdashboard::flex_dashboard
---

```{r}
library(flexdashboard)
library(spotifyr)
library(tidyverse)
library(plotly)
library(compmus)
library(purrr)
library(htmlwidgets)
library(tidymodels)
library(ggdendro)
library(heatmaply)
```


```{r}
pablohoney <- get_playlist_audio_features("", "5o9KFQJ6uxvaGCihXtxSMv")
thebends <- get_playlist_audio_features("", "7297Y5C4lQ9c8RiIeZSo4c")
okcomputer <- get_playlist_audio_features("", "31M9flclurZ7gSD4tjqjLs")
kidamnesiac <- get_playlist_audio_features("", "0t7DkHCyUMmfl53CRhmKd0")
hailtothethief <- get_playlist_audio_features("", "3daz1tZ64UA3KMbbyPPoXM")
inrainbows <- get_playlist_audio_features("", "2k3CNLrpE5iGzDTuzfHZGT")
thekingoflimbs <- get_playlist_audio_features("", "4S60o4zSaeMfMYwi5Ndxqf")
amoonshapedpool <- get_playlist_audio_features("", "0rllYNwldDnjrOGx03VMnc")
```

```{r}
# pablohoney <- pablohoney |>
#   add_audio_analysis()
# thebends <- thebends |>
#   add_audio_analysis()
# okcomputer <- okcomputer |>
#   add_audio_analysis()
# kidamnesiac <- kidamnesiac |>
#   add_audio_analysis()
# hailtothethief <- hailtothethief |> 
#   add_audio_analysis()
# inrainbows <- inrainbows |> 
#   add_audio_analysis()
# thekingoflimbs <- thekingoflimbs |>  
#   add_audio_analysis()
# amoonshapedpool <- amoonshapedpool |> 
#   add_audio_analysis()
```

    
Page 1
=====================================  

Sidebar {.sidebar data-width=275px}
------------------------------------- 

Over the years, Radiohead has been lauded as one of the best bands of all time by both critics and the public. However, like most artists and bands, they too have had to take the time to find their true sound. What started out as a run-off-the-mill alternative rock band quickly grew to something entirely new. 

In this project, I want to show you how the sound of Radiohead has changed from their first album, Pablo Honey, to their most recent release, A Moon Shaped Pool. We'll find out exactly what makes each of their albums special through Spotify's intricate track analysis features. 

I chose to analyze Radiohead for this project because they are one of my favorite bands, so besides finding out about their musical evolution, I also hope to find out some things about my personal listening behavior and be able to express those alongside the facts about Radiohead. 

```{=html}
<iframe src="https://open.spotify.com/embed/playlist/1hOCJdAtWmTl2Een00H0wV?utm_source=generator&theme=0" width="100%" height="380" frameBorder="0" allowtransparency="true" allow="encrypted-media" data-external="1"></iframe>
```

Column
-------------------------------------

### Radiohead (Pablo Honey era)

```{r picture, echo = F, out.width = '100%', out.height= '100%'}
knitr::include_graphics("Images/radiohead-pablo-honey-1993-7b6d5a3d-fe03-46f5-a68d-f628b982c514.png")
```

### Radiohead (Pablo Honey era 2) 

```{r picture2, echo = F, out.width = '100%', out.height= '100%'}
knitr::include_graphics("Images/qogsnuj192ly.png")
```

Column
-------------------------------------
### If we smile can we go?

```{r picture3, echo = F, out.width = '100%', out.height= '100%'}
knitr::include_graphics("Images/jo2y80wp0pm11_1.png")
```

### Radiohead (OK Computer era) 

```{r picture4, echo = F, out.width = '100%', out.height= '100%'}
knitr::include_graphics("Images/a78radiohead.png")
```

Page 2
=====================================  

Sidebar {.sidebar data-width=400px}
-------------------------------------   

Let's first take a look at some basic features of Radiohead's 8 main releases, ranging from 1993 to 2016. Their first album, Pablo Honey, contains all the characteristics one would expect from the grungy alternative rock album it is. All the songs are relatively high in energy and valence and the majority of the tracks fall within the major mode. In comparison to later albums, the tracks are all pretty loud as well. 

This trend then continues on through the next 2 albums, The Bends and OK Computer, although some exceptions to the rule become clear. Both albums contain more songs with a low energy and a low valence. Now, a shift in tone becomes clear. The next album, Kid A Mnesiac (A double album containing two previously individual releases: Kid A and Amnesiac), almost entirely consists of songs on the lower end of the valence and energy spectrum. These albums marked the band's departure from more standard alternative rock and saw them adapting a sound that was influenced by electronic music from the time. 

Their next album, Hail to the Thief, sees the band returning to the traditional rock sound with more loud, high-energy songs. A return which is somewhat cut short by the next album, In Rainbows, which beautifully combines the band's electronic influences and alternative rock roots into a melancholic masterpiece. Make no mistake though, there are some outliers in this album. The King of Limbs is heavily electronic, containing almost no traditional sounds that the listeners were used to at the time. This, along with many collaborations with electronic artists and DJ's, results in a high-energy album that still conveys Radiohead's gloomy sound. The final album in this corpus, A Moon Shaped Pool, is an almost completely gloomy, low-energy, and very quiet album, with one noteable outlier, "Burn the Witch".

Radiohead also distinguish themselves from other bands by using relatively complex song structures. It is sometimes argued that this complexity only came to be in their later albums. I, however, think that this is nonsense. To demonstrate this, I could pick out the most musically complex track of every album, but that would defeat the purpose of my argument. Instead, I choose to visualize my favorite track from each album to show that, even in their earlier albums, Radiohead were already handling pretty complex stuff and, on the contrary, that their later albums also contain tracks with a rather simple structure (although this does not take away their beauty whatsoever). 
In the next section, I will look at the structure and timbre components of 8 of these tracks. 

Column {.tabset}
-------------------------------------

### Pablo Honey

```{r}
# Create a data frame with the relevant features and track names
pablohoney_df <- data.frame(
  Track = pablohoney$track.name,
  Energy = pablohoney$energy,
  Valence = pablohoney$valence,
  Loudness = pablohoney$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(pablohoney_df$Loudness)

custom_text <- paste(
  "Track: ", pablohoney_df$Track,
  "<br>Energy: ", pablohoney_df$Energy,
  "<br>Valence: ", pablohoney_df$Valence,
  "<br>Loudness: ", round(pablohoney_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = pablohoney_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "Pablo Honey",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```


### The Bends

```{r}
# Create a data frame with the relevant features and track names
thebends_df <- data.frame(
  Track = thebends$track.name,
  Energy = thebends$energy,
  Valence = thebends$valence,
  Loudness = thebends$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(thebends_df$Loudness)

custom_text <- paste(
  "Track: ", thebends_df$Track,
  "<br>Energy: ", thebends_df$Energy,
  "<br>Valence: ", thebends_df$Valence,
  "<br>Loudness: ", round(thebends_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = thebends_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "The Bends",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```   


### Ok Computer
    
```{r}
# Create a data frame with the relevant features and track names
okcomputer_df <- data.frame(
  Track = okcomputer$track.name,
  Energy = okcomputer$energy,
  Valence = okcomputer$valence,
  Loudness = okcomputer$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(okcomputer_df$Loudness)

custom_text <- paste(
  "Track: ", okcomputer_df$Track,
  "<br>Energy: ", okcomputer_df$Energy,
  "<br>Valence: ", okcomputer_df$Valence,
  "<br>Loudness: ", round(okcomputer_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = okcomputer_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "OK Computer",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```

### Kid A Mnesiac 

```{r}
# Create a data frame with the relevant features and track names
kidamnesiac_df <- data.frame(
  Track = kidamnesiac$track.name,
  Energy = kidamnesiac$energy,
  Valence = kidamnesiac$valence,
  Loudness = kidamnesiac$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(kidamnesiac_df$Loudness)

custom_text <- paste(
  "Track: ", kidamnesiac_df$Track,
  "<br>Energy: ", kidamnesiac_df$Energy,
  "<br>Valence: ", kidamnesiac_df$Valence,
  "<br>Loudness: ", round(kidamnesiac_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = kidamnesiac_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "Kid A Mnesiac",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```

### Hail to the Thief 

```{r}
# Create a data frame with the relevant features and track names
hailtothethief_df <- data.frame(
  Track = hailtothethief$track.name,
  Energy = hailtothethief$energy,
  Valence = hailtothethief$valence,
  Loudness = hailtothethief$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(hailtothethief_df$Loudness)

custom_text <- paste(
  "Track: ", hailtothethief_df$Track,
  "<br>Energy: ", hailtothethief_df$Energy,
  "<br>Valence: ", hailtothethief_df$Valence,
  "<br>Loudness: ", round(hailtothethief_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = hailtothethief_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "Hail to the Thief",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```

### In Rainbows

```{r}
# Create a data frame with the relevant features and track names
inrainbows_df <- data.frame(
  Track = inrainbows$track.name,
  Energy = inrainbows$energy,
  Valence = inrainbows$valence,
  Loudness = inrainbows$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(inrainbows_df$Loudness)

custom_text <- paste(
  "Track: ", inrainbows_df$Track,
  "<br>Energy: ", inrainbows_df$Energy,
  "<br>Valence: ", inrainbows_df$Valence,
  "<br>Loudness: ", round(inrainbows_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = inrainbows_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "In Rainbows",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```

### The King of Limbs

```{r}
# Create a data frame with the relevant features and track names
thekingoflimbs_df <- data.frame(
  Track = thekingoflimbs$track.name,
  Energy = thekingoflimbs$energy,
  Valence = thekingoflimbs$valence,
  Loudness = thekingoflimbs$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(thekingoflimbs_df$Loudness)

custom_text <- paste(
  "Track: ", thekingoflimbs_df$Track,
  "<br>Energy: ", thekingoflimbs_df$Energy,
  "<br>Valence: ", thekingoflimbs_df$Valence,
  "<br>Loudness: ", round(thekingoflimbs_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = thekingoflimbs_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "The King of Limbs",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```

### A Moon Shaped Pool

```{r}
# Create a data frame with the relevant features and track names
amoonshapedpool_df <- data.frame(
  Track = amoonshapedpool$track.name,
  Energy = amoonshapedpool$energy,
  Valence = amoonshapedpool$valence,
  Loudness = amoonshapedpool$loudness
)

# Normalize loudness values to range between 0 and 1 for marker colors
scaled_loudness <- scales::rescale(amoonshapedpool_df$Loudness)

custom_text <- paste(
  "Track: ", amoonshapedpool_df$Track,
  "<br>Energy: ", amoonshapedpool_df$Energy,
  "<br>Valence: ", amoonshapedpool_df$Valence,
  "<br>Loudness: ", round(amoonshapedpool_df$Loudness, 2)
)

# Define tick values and labels for the colorbar (only -60 and 0)
colorbar_ticks <- c(-60, 0)
colorbar_labels <- as.character(colorbar_ticks)

# Create scatter plot matrix with marker color representing loudness
scatter_matrix <- plot_ly(
  data = amoonshapedpool_df,
  x = ~Valence,
  y = ~Energy,
  text = custom_text,
  type = "scatter",
  mode = "markers",
  marker = list(
    color = scaled_loudness,
    colorscale = "Viridis", # Choose a color scale
    opacity = 0.7,
    size = 8,
    colorbar = list(
      title = "Loudness (High - Low)", # Add a title to the colorbar
      tickvals = colorbar_ticks, # Specify tick values
      ticktext = colorbar_labels # Specify tick labels
    )
  )
) %>%
  layout(
    title = "A Moon Shaped Pool",
    xaxis = list(title = "Valence"),
    yaxis = list(title = "Energy")
  )

# Print the scatter plot matrix
scatter_matrix
```

# Blow Out - Remix {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

The first track we'll analyse is Blow Out, which, although not very complex musically, more than makes up for that in its overall sound. The song starts out with a simple build-up of around a minute. This build-up corresponds with the first square in the Self-Similarity Matrix. After this, the guitarists break down into a noisy, chaotic part of the song, which is visibly harder to differentiate in the Chromagram. The yellow lines that were clearly visible in the previous part are now more vaguely defined, corresponding to the noise that is introduced in this part of the song. The build-up then repeats until around the 2 and a half minute mark, where the song breaks down again. A siren-like guitar noise is introduced, causing the vagueness of the chromagram to increase once more up until the final strum.

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
blowout <-
  get_tidy_audio_analysis("1XO6WiimPgd8X7znxfK7fC") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

blowout |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Blow Out - Remix") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
blowout <-
  get_tidy_audio_analysis("1XO6WiimPgd8X7znxfK7fC") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

blowout |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```


# Just {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

Resulting from a competition between two band members to see who could come up with the weirdest chord progression, Just is one of the most musically complex tracks of the band's sophomore album, The Bends. This complexity is clearly visible in the chromagram, which is nearly unintelligible. Luckily, the Self-Similarity Matrix can provide some insight into the roughly nine sections of this track. The first part consists of a small, noisy build-up, which transitions into the pre-chorus followed by the chorus. This chorus is rather interesting, because it is brought back three times in the song, with each subsequent appearance taking just a bit longer than the previous. The choruses in this track correspond to the third, fifth, and seventh square in the Self-Similarity Matrix respectively. Just before the final chorus, the song halts for just a bit, resulting in the characteristic yellow line at around 145 seconds into the song. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
just <-
  get_tidy_audio_analysis("1dyTcli07c77mtQK3ahUZR") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

just |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Just") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
just <-
  get_tidy_audio_analysis("1dyTcli07c77mtQK3ahUZR") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

just |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```

# Man of War {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

Arguably the most Bond-esque sounding track in the band's entire discography , besides the one they actually wrote for 2016's Spectre (the track is aptly named Spectre as well), which sadly got scrapped. It is arguably the most 'generic' track I chose for this part of the project, simply because the structure is most recognisable in other popular songs. The song has two motifs, of which the first is the simple riff heard in the beginning of the track. This motif is present in the song until around 2 minutes in. The second riff comes in just before the 2 minute mark and repeatedly appears in various forms for the rest of the song. Possibly, this use of similar riffs causes some confusion in the Self-Similarity Matrix, which is uncharacteristically vague for this track. This shows that, although a Self-Similarity Matrix and Chromagram on their own often provide ample information on a track, when you combine the two, that's when you really get to know a song. Following from this statement, the chromatic structure of this track is easily found out from the Chromagram, which is almost entirely well-defined. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
manofwar <-
  get_tidy_audio_analysis("5HtNvKihacAXt34DDYYxBC") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

manofwar |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Man of War") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
manofwar <-
  get_tidy_audio_analysis("5HtNvKihacAXt34DDYYxBC") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

manofwar |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```

# Motion Picture Soundtrack {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

Looking back at the introductory visualisation of my project on the Kid A Mnesiac chart, the valence and energy of this piece are among the lowest of the entire album, and with that, the band's full discography, making this one of the band's most melancholic pieces. The instruments in this piece flow beautifully, which, unfortunately, also means that the corresponding Self-Similarity Matrix is looking a bit fuzzy. There are, however, still four clearly defined sections in this song. The first square in the matrix represents the solemn organ sound that is heard in the first 40 seconds of the piece. After this, Thom Yorke's voice appears, resulting in a new part of the matrix. This is followed by a brief silence, after which the same pattern continues, but now with a sweeping harp sound in the background. The final section of the song contains something that almost sounds like a choir from the heavens and then gradually fades into silence with the harp as the last remaining instrument. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
motionpicture <-
  get_tidy_audio_analysis("5RxiwMqRNyPYjJTobU65UT") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

motionpicture |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Motion Picture Soundtrack") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
motionpicture <-
  get_tidy_audio_analysis("5RxiwMqRNyPYjJTobU65UT") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

motionpicture |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```

# A Wolf At the Door {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

This track contains what I find one of Thom Yorke's most interesting vocal performances, as the way he sings/speaks in the first part is unlike anything else in the band's discography. This performance is marked by the second square in the Self-Similarity Matrix and is followed by an almost hypnotic chant that appears roughly halfway through the song. This chant starts out calm but quickly escalates to the final part of the song. The final part contains a similarly interesting performance, this time backed up by background vocals that make it sound more melancholic and haunting, yet at the same time strangely hopeful. This track is also the final track on the album Hail to the Thief, closing off the album with strange, mixed feelings. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
wolf <-
  get_tidy_audio_analysis("3OHevW2cUT176DXWV0lHg9") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

wolf |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="A Wolf At the Door") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
wolf <-
  get_tidy_audio_analysis("3OHevW2cUT176DXWV0lHg9") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

wolf |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```

# Weird Fishes/Arpeggi {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

Weird Fishes/Arpeggi is my favorite piece of music ever, yet I have always found it hard to describe this song in words. The feeling it gives me is best described as the gray area between hopefulness and despair, something similar to what's described by the lyrics: 'everybody leaves, if they get the chance. And this is my chance'. Because I don't think words can truly do the meaning of this piece justice, it's more suitable just to analyze the technical components. The main part of this song is characterised by a guitar playing arpeggiated chords, meaning that each note in a chord is played progressively rising or descending, rather than all at once, as is more common. This pattern is fairly simple and can be seen in the Chromagram as it repeats for about the first 2 minutes of the song. Following this section, another guitar starts playing arpeggiated chords softly in the background, causing a compounding effect that sounds incredible. In the next section, the drumming ceases for a while before suddenly continuing at exactly 3 minutes and 41 seconds, starting the final section of the song, where everything comes together: guitars, keyboards, drums, and vocals all create a beautiful, arpeggiated conclusion to my favorite song of all time. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
weirdfishes <-
  get_tidy_audio_analysis("4wajJ1o7jWIg62YqpkHC7S") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

weirdfishes |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Weird Fishes/Arpeggi") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
weirdfishes <-
  get_tidy_audio_analysis("4wajJ1o7jWIg62YqpkHC7S") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

weirdfishes |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```

# Separator {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

The King of Limbs may be Radiohead's most controversial album, as it saw them piecing together music on a computer using looped tracks. The specific producing technique used in this album caused most of it to sound repetitive and not like any other Radiohead album at the time. Although it is my personal least favorite album by the band, it still contains some beautiful pieces of music. The looping structure of this song is clearly visible in the Chromagram and Self-Similarity Matrix. Both contain near-consistent patterns: the Chromagram has yellow clear lines on C and A# throughout almost the entire track and the Self-Similarity Matrix contains tons of little squares. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
separator <-
  get_tidy_audio_analysis("2fV57qob1dYMJKEfTwHOt1") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

separator |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Separator") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
separator <-
  get_tidy_audio_analysis("2fV57qob1dYMJKEfTwHOt1") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

separator |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```

# Ful Stop {data-navmenu="Page 3"}

Sidebar {.sidebar}
-------------------------------------  

Although the Self-Similarity Matrix of this track looks like a piece of art on its own, it is not very telling. The biggest transition in the piece, which occurs at 3:11, where bass and, subsequently, kick in, and the tempo picks up, is not really visible from both visualisations. 

Column {.tabset}
------------------------------------- 

### Chromagram

```{r}
fulstop <-
  get_tidy_audio_analysis("6nOsTV3cMjLh3k6Wpk468L") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

fulstop |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="Ful Stop") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### SSM

```{r}
fulstop <-
  get_tidy_audio_analysis("6nOsTV3cMjLh3k6Wpk468L") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

fulstop |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")
```


Page 4
=====================================     

Sidebar {.sidebar}
-------------------------------------  

Now that we looked at some individual pieces from Radiohead's discography, let's take a look at how their music has changed throughout the years on a more general level. 

Column {.tabset}
-------------------------------------

### Chart 1

```{r}
# radiohead <- bind_rows(pablohoney, thebends, okcomputer, kidamnesiac, hailtothethief, inrainbows, thekingoflimbs, amoonshapedpool)

radiohead1 <- bind_rows(pablohoney, thebends, okcomputer)
radiohead2 <- bind_rows(kidamnesiac, hailtothethief)
radiohead3 <- bind_rows(inrainbows, thekingoflimbs, amoonshapedpool)
```   

```{r}
radiohead1 |>
  mutate(
    sections =
      map(
        sections,                                    # sections or segments
        summarise_at,
        vars(tempo, loudness, duration),             # features of interest
        list(section_mean = mean, section_sd = sd)   # aggregation functions
      )
  ) |>
  unnest(sections) |>
  ggplot(
    aes(
      x = tempo,
      y = tempo_section_sd,
      colour = playlist_name,
      alpha = loudness
    )
  ) +
  geom_point(aes(size = duration / 60)) +
  geom_rug() +
  theme_minimal() +
  ylim(0, 5) +
  labs(
    x = "Mean Tempo (bpm)",
    y = "SD Tempo",
    colour = "Album",
    size = "Duration (min)",
    alpha = "Volume (dBFS)"
  )

radiohead2 |>
  mutate(
    sections =
      map(
        sections,                                    # sections or segments
        summarise_at,
        vars(tempo, loudness, duration),             # features of interest
        list(section_mean = mean, section_sd = sd)   # aggregation functions
      )
  ) |>
  unnest(sections) |>
  ggplot(
    aes(
      x = tempo,
      y = tempo_section_sd,
      colour = playlist_name,
      alpha = loudness
    )
  ) +
  geom_point(aes(size = duration / 60)) +
  geom_rug() +
  theme_minimal() +
  ylim(0, 5) +
  labs(
    x = "Mean Tempo (bpm)",
    y = "SD Tempo",
    colour = "Album",
    size = "Duration (min)",
    alpha = "Volume (dBFS)"
  )

radiohead3 |>
  mutate(
    sections =
      map(
        sections,                                    # sections or segments
        summarise_at,
        vars(tempo, loudness, duration),             # features of interest
        list(section_mean = mean, section_sd = sd)   # aggregation functions
      )
  ) |>
  unnest(sections) |>
  ggplot(
    aes(
      x = tempo,
      y = tempo_section_sd,
      colour = playlist_name,
      alpha = loudness
    )
  ) +
  geom_point(aes(size = duration / 60)) +
  geom_rug() +
  theme_minimal() +
  ylim(0, 5) +
  labs(
    x = "Mean Tempo (bpm)",
    y = "SD Tempo",
    colour = "Album",
    size = "Duration (min)",
    alpha = "Volume (dBFS)"
  )
```

### Chart 2

```{r}
radiohead1 |>
  mutate(
    timbre =
      map(
        segments,
        compmus_summarise,
        timbre,
        method = "mean"
      )
  ) |>
  select(playlist_name, timbre) |>
  compmus_gather_timbre() |>
  ggplot(aes(x = basis, y = value, fill = playlist_name)) +
  geom_violin() +
  scale_fill_viridis_d() +
  labs(x = "Spotify Timbre Coefficients", y = "", fill = "Album")

radiohead2 |>
  mutate(
    timbre =
      map(
        segments,
        compmus_summarise,
        timbre,
        method = "mean"
      )
  ) |>
  select(playlist_name, timbre) |>
  compmus_gather_timbre() |>
  ggplot(aes(x = basis, y = value, fill = playlist_name)) +
  geom_violin() +
  scale_fill_viridis_d() +
  labs(x = "Spotify Timbre Coefficients", y = "", fill = "Album")

radiohead3 |>
  mutate(
    timbre =
      map(
        segments,
        compmus_summarise,
        timbre,
        method = "mean"
      )
  ) |>
  select(playlist_name, timbre) |>
  compmus_gather_timbre() |>
  ggplot(aes(x = basis, y = value, fill = playlist_name)) +
  geom_violin() +
  scale_fill_viridis_d() +
  labs(x = "Spotify Timbre Coefficients", y = "", fill = "Album")
```

Page 5
=====================================     

Sidebar {.sidebar}
-------------------------------------  

When discussing the complexity of Radiohead songs, one song in particular never fails to be mentioned: Paranoid Android. This song contains significant tempo changes that are pulled off very well, hopefully also making them visible in the Tempogram. Most sources online tell that this song has a BPM of around 84. That's how the song starts out at least. After around 3 and a half minutes, the tempo slows down to around 63 BPM, before returning to it's original state for the final section of the song. This is represented in a somewhat vague way in the Tempogram, so let me explain. The yellow lines around 330 and 250 BPM are multiples of the original tempo's of the song: 84 and 62 BPM. This is figured out in the second visualization, where the first tempo is correct, but the second tempo is still visualized in double-time. The coda of this piece is presumably a mystery to the computer, as there is no clear yellow line visible in this part.

Column {.tabset}
-------------------------------------

### Chart 1

```{r}
paranoid <- get_tidy_audio_analysis("6LgJvl0Xdtc73RJ1mmpotq")

paranoid |>
  tempogram(window_size = 8, hop_size = 1, cyclic = FALSE) |>
  ggplot(aes(x = time, y = bpm, fill = power)) +
  geom_raster() +
  scale_fill_viridis_c(guide = "none") +
  labs(x = "Time (s)", y = "Tempo (BPM)") +
  theme_classic()
```   

### Chart 2

```{r}
paranoid |>
  tempogram(window_size = 8, hop_size = 1, cyclic = TRUE) |>
  ggplot(aes(x = time, y = bpm, fill = power)) +
  geom_raster() +
  scale_fill_viridis_c(guide = "none") +
  labs(x = "Time (s)", y = "Tempo (BPM)") +
  theme_classic()
```